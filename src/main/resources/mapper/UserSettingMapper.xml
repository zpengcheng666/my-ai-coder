<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.ai.mapper.UserSettingMapper">
    
    <resultMap id="BaseResultMap" type="org.example.ai.entity.UserSetting">
        <id column="id" property="id"/>
        <result column="user_id" property="userId"/>
        <result column="user_name" property="userName"/>
        <result column="stream_mode" property="streamMode"/>
        <result column="auto_scroll" property="autoScroll"/>
        <result column="show_timestamp" property="showTimestamp"/>
        <result column="api_base_url" property="apiBaseUrl"/>
        <result column="timeout" property="timeout"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>
    
    <sql id="Base_Column_List">
        id, user_id, user_name, stream_mode, auto_scroll, show_timestamp, api_base_url, timeout, create_time, update_time
    </sql>
    
    <select id="findByUserId" resultMap="BaseResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM user_setting
        WHERE user_id = #{userId}
        ORDER BY id DESC
        LIMIT 1
    </select>
    
    <update id="updateByUserId">
        UPDATE user_setting
        SET user_name = #{userName},
            stream_mode = #{streamMode},
            auto_scroll = #{autoScroll},
            show_timestamp = #{showTimestamp},
            api_base_url = #{apiBaseUrl},
            timeout = #{timeout},
            update_time = NOW()
        WHERE user_id = #{userId}
    </update>
    
</mapper>